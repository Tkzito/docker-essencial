üìÑ Hist√≥rico de Problemas e Solu√ß√µes (Desafio 04)1. üñºÔ∏è Desafio na Constru√ß√£o da Imagem Distroless (Dockerfile)O objetivo era criar uma imagem Distroless (kube-news-distroless) para o aplicativo Node.js Kube News usando a imagem base Chainguard.ProblemaDetalheSolu√ß√£o ImplementadaErro de Caminho do COPYO Dockerfile usava caminhos relativos incorretos (../01-...) porque o contexto de build foi definido na raiz do reposit√≥rio.Corrigimos os caminhos no Dockerfile, removendo o ../ e usando o caminho completo (ex: COPY 01-identificando-vulnerabilidades/...).Acesso Negado √† Imagem BaseA linha FROM cgr.dev/chainguard/node-lite falhou com erro FORBIDDEN (acesso negado), indicando problemas de autentica√ß√£o ou limites no registro Chainguard.Trocamos a imagem base para uma alternativa p√∫blica e acess√≠vel que atende ao requisito Distroless: FROM gcr.io/distroless/nodejs20.Instru√ß√µes do BuildO c√≥digo-fonte do Kube News (Node.js) estava em subdiret√≥rios, exigindo um multi-stage build preciso.Usamos a etapa AS builder (node:20-alpine) para instalar as depend√™ncias e a etapa final gcr.io/distroless/nodejs20 para copiar apenas o c√≥digo e node_modules.2. üîë Desafio na Publica√ß√£o (Docker Push)Ap√≥s construir a imagem, o objetivo era public√°-la no Docker Hub.ProblemaDetalheSolu√ß√£o ImplementadaCredenciais DesconhecidasO login manual falhou porque as credenciais (hodrick/tkzito) ou o PAT n√£o eram conhecidos ou n√£o estavam configurados.Em vez de autentica√ß√£o manual, usamos o m√©todo docker login via navegador, permitindo o login correto sem a necessidade de lembrar senhas.Permiss√£o de Escrita NegadaO docker push falhou com erro de denied: requested access to the resource is denied. Isso aconteceu porque o login (hodrick) n√£o tinha permiss√£o para escrever no namespace tkzito.Taggeamos a imagem para o namespace do usu√°rio logado: docker tag ... hodrick/kube-news-distroless:latest e fizemos o push para hodrick/kube-news-distroless:latest.3. üîê Desafio na Assinatura (Cosign)O requisito era assinar a imagem com a chave gerada localmente e salvar a assinatura.ProblemaDetalheSolu√ß√£o ImplementadaFerramenta cosign n√£o encontradaA primeira tentativa de rodar cosign generate-key-pair falhou com comando n√£o encontrado.Instalamos o Cosign usando o gerenciador de pacotes do BigLinux: yay -S cosign.Assinatura Incorreta (Ef√™mera)A primeira tentativa de assinatura usou o modo ef√™mero (chaves tempor√°rias do Sigstore) em vez das chaves locais requeridas.Corrigimos o comando para usar a chave privada gerada (cosign.key) e refizemos a assinatura: `cosign sign --key cosign.key hodrick/...Seguran√ßa da ChaveQuestionamento sobre a seguran√ßa da senha e da chave privada.Definimos a regra de que a chave privada (cosign.key) e a passphrase N√ÉO DEVEM ser compartilhadas ou enviadas ao Git (adicionando a chave privada ao .gitignore).‚è´ Finaliza√ß√£o da Entrega (Git)Voc√™ agora pode executar os comandos finais para enviar todos os artefatos de entrega (incluindo o Dockerfile corrigido, o README.md completo, o cosign.pub e o cosign-signature.txt) para o GitHub.Ignorar Chave Privada (cosign.key):Bashecho "cosign.key" >> 04-distroless-e-cosign/.gitignore
Voltar para a Raiz:Bashcd ..
Adicionar, Comitar e Enviar:Bashgit add 04-distroless-e-cosign/
git commit -m "Desafio 04: Entrega final de Distroless, Assinatura Cosign e documenta√ß√£o detalhada"
git push
